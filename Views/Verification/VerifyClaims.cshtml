@{
    ViewData["Title"] = "Verify Claims";
}
@model IEnumerable<ContractMonthlyClaimSystem.Models.Verification>
<!--submit a claim
   --PCs can verify and deny  submiited claims in tabular format
   -- PCs should recive an alert for every submitted 
   --The appropriate PCs fould be notified of claims awaiting verfication on system and via emailil
   -- There will be a reason for denied claims,ICs will have 2 working days to adjust denied claims and resubmit
   --PCs can only view ICs under  their assignned qualification
   --claims will be filtered by qualifications then modules and semester
   --the submitted claim and adjusted claim should be diffent
   --users must be tracked for security purposes
   --reasons for denail - incorrect claim date, incorrect claim register URL,invalid claim hours, invalid claim rate
   REMOVE SAMPLE DATA IN PART 2
    -->
<div class="table-container">
    <h3>Verify Claims</h3>
    <script src="js\site.js"></script>
    <br />
        <h3>Provide reasons of denied claims and send back</h3>
            <h3>NB!:All claims must be verfied within 3 working days of submittion</h3>
              <br /> 
                <h3>IC ID</h3>
                <!--HARD CODE SAMPLE DATA FOR POE, screenshots should have sample data, 5 rows of sample data-->
                <table class="table">
                    <thead>
                        <tr>
                            <th>Verification ID</th>
                            <th>Claim ID</th>
                           <!-- <th>PC ID</th>cast PC11230-->
                            <th>IC ID</th><!--IC ID add casting, e,g IC101298-->
                            <th>Qualification</th>
                            <th>Module Code</th>
                            <th>Semester</th>
                            <th>Group</th>
                            <th>Lesson Date</th>
                            <th>Hours Worked</th>
                            <th>Rate</th>
                            <th>Total</th><!--Hours worked * rate-->
                            <th>Register URL</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                       
            @foreach (var verify in Model)
            {
                <tr>
                    <td>@verify.FormattedVerificationId</td>
                    <td>@verify.FormattedClaimId</td>
                    <td>@verify.ICID</td>
                    <td>@verify.QualificationName</td>
                    <td>@verify.ModuleCode</td>
                    <td>@verify.Semester</td>
                    <td>@verify.Group</td>
                    <td>@verify.LessonDate</td>
                    <td>@verify.HoursWorked</td>
                    <td>@verify.Rate</td>
                    <td>@verify.Total.ToString("C", new System.Globalization.CultureInfo("en-ZA")) </td>
                    <td>
                        @if (!string.IsNullOrEmpty(verify.FileName))
                        {
                            <a href="@(Url.Content("~/claim docs/" + verify.FormattedClaimId + "/" + verify.FileName))" target="_blank">
                                @verify.FileName
                            </a>
                        }
                    </td>
                    <td>@verify.Status</td>
                    <td>
                    <form asp-action="ChangeStatus" method="post">
                        <input type="hidden" name="id" value="@verify.ClaimId" />
                        <button class="btn btn-secondary btn-sm" type="submit" name="newStatus" value="Approved" onclick="return showVerifiedMessage()">Verify</button>
                            <button class="btn btn-secondary btn-sm" type="button" name="newStatus" value="@verify.ClaimId" onclick="if (showDenialMessage()) { showDenialReason(this); }">Deny</button>
                    </form>
                    <form asp-action="ChangeStatus" id="denialForm-@verify.ClaimId" style="display:none;" method="post" onsubmit="return validateDenialForm(this)">
                        <input type="hidden" name="id" value="@verify.ClaimId" />
                        <input type="hidden" name="newStatus" value="Rejected" />
                        <select name="denialReason" required>
                            <option value="">Select a reason</option>
                            <option value="ICD">Incorrect claim date</option>
                            <option value="ICURL">Incorrect claim register URL</option>
                            <option value="ICHW">Invalid claim hours</option>
                            <option value="ICR">Invalid claim rate</option>
                        </select>
                        <button class="btn btn-secondary btn-sm" type="submit">Submit</button>
                    </form>
                    </td>
                </tr>
  
            }
    </tbody>
</table>
</div>
